!function(u){"use strict";var _x=wp.i18n._x;u(document).ready(function(){function c(e){for(var a=u(".custom_field_map").length;0!=e.parent().find('[id^="custom_field_maps_wrap"] input[name="custom_map['+a+'][key]"]').length;)a++;var t=u(u("#field_map_template").html());return t.find('input[name="key"]').attr("name","custom_map["+a+"][key]"),t.find('input[name="value"]').attr("name","custom_map["+a+"][value]"),e.parent().find('[id^="custom_field_maps"]').append(t),t}u(".delete_issue").length&&u(".delete_issue").click(function(e){e.preventDefault();var a=u("#cp_id").val(),t=u(this).closest("tr").find("td.name").text(),n=u(this).attr("data-bugtracker-id");if(confirm(_x("Are you sure you want to delete issue","Integration Center delete issue","appq-integration-center")+" "+n+" - "+t+"?")){var i=u(this).removeClass("fa-close"),s=this;u(this).html('<span class="fa fa-spin fa-spinner"></span>'),u.ajax({type:"post",dataType:"json",url:integration_center_obj.ajax_url,data:{action:"appq_delete_bug_from_bugtracker",cp_id:a,bugtracker_id:n}}).then(function(e){e.success?(u(s).closest("td").find(".open_bug_menu").removeClass("fa-upload").addClass("fa-close").addClass("text-danger"),u(s).closest("tr").find(".is_uploaded").html(""),u(s).closest("td").find("button").prop("disabled",!0),u(s).remove(),e.data.auth_error?toastr.warning(e.data.message):toastr.success(e.data.message)):(u(s).html(i),toastr.error(e.data.message))})}}),u(".open_bug_menu").length&&u(".open_bug_menu").click(function(e){e.preventDefault(),u(this).closest("td").find(".bug_menu").is(":visible")?u(this).closest("td").find(".bug_menu").hide():(u(".bug_menu").hide(),u(this).closest("td").find(".bug_menu").show())}),u("#custom_field_maps").on("click",".remove",function(){u(this).closest(".custom_field_map").remove()}),u("#add_field_modal, #edit_available_field_modal").on("hidden.bs.modal",function(e){u("#add_field_modal").find("input").val(""),u("#edit_available_field_modal").find("input").val(""),u("#custom_field_maps_add *").remove(),u("#custom_field_maps_edit *").remove()}),u(".available_fields .custom").length&&u(".available_fields .custom").click(function(){var t=u(this).data("map"),e=u(this).data("source"),a=u(this).data("name"),n=u(u(this).data("target"));n.find('input[name="custom_map_source"]').val(e),n.find('input[name="custom_map_name"]').val(a),Object.keys(t).forEach(function(e){var a=c();a.find(".key").val(e),a.find(".value").val(t[e])}),n.modal("show")}),u(".add_new_field_map").click(function(e){c(u(this))}),u("#add_new_field, #edit_field").click(function(e){e.preventDefault();var a,t,n,i,s=this,r=u(this).html(),o=u("#cp_id").val();"edit_field"===u(this).attr("id")?(a="#edit_available_field_form",t="appq_edit_custom_field",n=4,i=_x("Custom field updated","Integration Center edit available field","appq-integration-center")):"add_new_field"===u(this).attr("id")&&(a="#add_custom_map",t="appq_add_custom_field",n=4,i=_x("Custom field added","Integration Center add available field","appq-integration-center"));var d=u(a+" input").serializeArray();if(u(this).html('<i class="fa fa-spinner fa-spin"></i>'),d.length>=n){var l=!0;d.forEach(function(e,a){e.value||(l=!1)}),l?(u(s).prop("disabled",!0),d.push({name:"cp_id",value:o}),d.push({name:"action",value:t}),u.ajax({type:"post",dataType:"json",url:integration_center_obj.ajax_url,data:d}).then(function(e){e.success?(toastr.success(i),location.reload()):toastr.error(_x("Something went wrong","Integration Center available fields modal error","appq-integration-center")),u(s).html(r),u(s).prop("disabled",!1)})):(toastr.error(_x("Please fill the mapping fields","Integration Center available fields modal error","appq-integration-center")),u(s).html(r),u(s).prop("disabled",!1))}else toastr.error(_x("Please fill the mapping fields","Integration Center available fields modal error","appq-integration-center")),u(s).html(r),u(s).prop("disabled",!1)}),u(document).on("click",'[data-target="#add_field_modal"]',function(){u("#add_new_field").prop("disabled",!1)}),u(document).on("click",'[data-target="#edit_available_field_modal"]',function(){var e=u(this).attr("data-target"),a=u(e),t=a.find('input[name="custom_map_source"]'),n=a.find('input[name="custom_map_name"]'),i=u(this).data("source"),s=u(this).data("name"),r=u(this).data("map"),o=0;for(var d in r){var l=r[d];c(u("#add_new_field_map")),a.find('input[name="custom_map['+o+'][key]"]').val(d),a.find('input[name="custom_map['+o+'][value]"]').val(l),o++}t.val(i),n.val(s)}),u(document).on("click",'[data-target="#delete_available_field_modal"]',function(){var e=u(this).attr("data-target"),a=u(e).find('input[name="name"]');a.val("");var t=u(this).data("name");t&&a.val(t)}),u("#delete_available_field").click(function(e){e.preventDefault();var a=this,t=u(this).html(),n=u("#cp_id").val();u(this).html('<i class="fa fa-spinner fa-spin"></i>'),u(this).prop("disabled",!0);var i=u("#delete_available_field_form").find('input[name="name"]').val(),s=[];s.push({name:"cp_id",value:n}),s.push({name:"name",value:i}),s.push({name:"action",value:"appq_delete_custom_field"}),u.ajax({type:"post",dataType:"json",url:integration_center_obj.ajax_url,data:s}).then(function(e){e.success?(u("#accordionFields").find('tr[data-name="'+i+'"]').remove(),toastr.error(_x("Custom field deleted","Integration Center delete custom field","appq-integration-center"))):toastr.error(_x("There was an error deleting custom field","Integration Center delete custom field error","appq-integration-center")),u(a).html(t),u(a).prop("disabled",!1),u("#delete_available_field_modal").modal("toggle")})}),u("#bugs-tabs-content .upload_bug").not(".disabled").click(function(){var e=u("#cp_id").val(),a=u(this).data("bug-id"),t=u(this);t.removeClass("fa-upload").addClass("fa-spinner fa-spin text-secondary disabled"),jQuery.ajax({type:"post",dataType:"json",url:integration_center_obj.ajax_url,data:{action:"appq_upload_bugs_to_bugtracker",cp_id:e,bug_id:a},success:function(e){t.removeClass("fa-spinner fa-spin").addClass("fa-upload"),e.success?t.closest("tr").find("td.is_uploaded").append('<span class="fa fa-check"></span>'):e.data.warning?(t.closest("tr").find("td.is_uploaded").append('<span class="fa fa-check"></span>'),toastr.warning(e.data.warning,"Your bug was uploaded, but there was some errors")):(t.removeClass("text-secondary disabled"),toastr.error(e.data))},error:function(e){t.removeClass("fa-spinner fa-spin text-secondary").addClass("fa-upload"),toastr.error(JSON.stringify(e))}})}),u("#bugs-tabs-content .update_bug").not(".disabled").click(function(){var e=u("#cp_id").val(),a=u(this).data("bug-id"),t=u(this);t.removeClass("fa-upload").addClass("fa-spinner fa-spin text-secondary disabled"),jQuery.ajax({type:"post",dataType:"json",url:integration_center_obj.ajax_url,data:{action:"appq_update_bugs_in_bugtracker",cp_id:e,bug_id:a},success:function(e){t.removeClass("fa-spinner fa-spin").addClass("fa-upload"),e.success?toastr.success(_x("Updated!","Integration Center available fields modal error","appq-integration-center")):(t.removeClass("text-secondary disabled"),toastr.error(e.data))},error:function(e){t.removeClass("fa-spinner fa-spin text-secondary").addClass("fa-upload"),toastr.error(JSON.stringify(e))}})}),u("#campaign-tabs .nav-link").click(function(){window.location.hash=u(this).attr("href")});var e=window.location.hash;u('#campaign-tabs a[href="'+e+'"]').click();new List("campaigns_list",{valueNames:["id","name","bugtracker"],plugins:[ListFuzzySearch({searchClass:"fuzzy-search",location:0,distance:100,threshold:.4,multiSearch:!0})]});var t=new List("bugs_list",{valueNames:["id","name","category","status","severity","tags","uploaded","duplicated"]});u("#bugs_list .send-all").click(function(e){e.preventDefault(),confirm(_x('Are you sure you want to process ALL the bugs? It will take a while. The list could contain REFUSED and PENDING bugs. If you want to send only some bugs, please use the "Send Selected" button.',"Integration Center send all confirm","appq-integration-center"))&&u("#bugs_list .fa-upload").not(".text-secondary").click()}),u("#bugs_list .send-selected").click(function(e){e.preventDefault(),u("#bugs_list .check:checked").each(function(){u(this).closest("tr").find(".fa-upload").not(".text-secondary").click()})}),u("#bugs_list .select_all").change(function(){u(this).prop("checked")?u("#bugs_list input.check").prop("checked",!0):u("#bugs_list input.check").prop("checked",!1)}),u("#bugs_list-search").on("keyup",function(){var a=u(this).val().split(" ").map(function(e){return e.split("+")});t.filter(function(e){var t=e.values();t=(t=Object.keys(t).map(function(e){return t[e]})).join(" ").toLowerCase();var n=!1;return a.forEach(function(e){var a=!0;e.forEach(function(e){e=e.toLowerCase(),a=a&&t.includes(e)}),n=n||a}),n})}),u("#save_general_settings").click(function(){var e=u("#campaign_id").val(),a=u(this),t=a.text(),n=u("#general_settings").serializeArray();n.push({name:"action",value:"appq_integration_center_save_settings"}),n.push({name:"cp_id",value:e}),a.text(""),a.append('<span class="fa fa-spinner fa-spin"></span>'),jQuery.ajax({type:"post",dataType:"json",url:integration_center_obj.ajax_url,data:n,success:function(e){a.text(t)}})}),u("#import_default_bug").click(function(e){e.preventDefault();var a=u("#cp_id").val(),t=u(this),n=u(this).html();t.html('<i class="fa fa-spinner fa-spin"></i>'),jQuery.ajax({type:"post",dataType:"json",url:integration_center_obj.ajax_url,data:{action:"appq_upload_bugs_to_bugtracker",cp_id:a,bug_id:"default"},success:function(e){t.html(n),e.success?(toastr.success(_x("Default bug uploaded","Integration Center default bug upload","appq-integration-center")),t.prop("disabled",!0),location.reload()):toastr.error(e.data)},error:function(e){t.html(n),toastr.error(JSON.stringify(e))}})}),u("#update_default_bug").click(function(e){e.preventDefault();var a=u("#cp_id").val(),t=u(this),n=u(this).html();t.html('<i class="fa fa-spinner fa-spin"></i>'),jQuery.ajax({type:"post",dataType:"json",url:integration_center_obj.ajax_url,data:{action:"appq_update_bugs_in_bugtracker",cp_id:a,bug_id:"default"},success:function(e){t.html(n),e.success?toastr.success(_x("Default bug updated","Integration Center default bug update","appq-integration-center")):toastr.error(e.data)},error:function(e){t.html(n),toastr.error(JSON.stringify(e))}})})})}(jQuery),function(a){"use strict";a(document).ready(function(){a("#add_new_field_values").change(function(){a("#custom_field_maps_wrap").toggle()}),a(".available_fields .custom").click(function(){a("#add_new_field_values").is(":checked")||a("#add_new_field_values").click()}),a("#add_field_modal").on("hidden.bs.modal",function(e){a("#add_new_field_values").is(":checked")&&a("#add_new_field_values").click(),a("#add_new_field").prop("disabled",!0),a("#custom_field_maps").html(""),a("#custom_map_source").val(""),a("#custom_map_name").val("")})})}(jQuery),function(t){"use strict";t(document).ready(function(){t("[data-copy-to-clipboard]").click(function(e){t(this).append("<input>"),t(this).find("input").val(t(this).text());var a=t(this).find("input")[0];a.select(),a.setSelectionRange(0,9999999),document.execCommand("copy"),t(this).find("input").remove(),t(this).append("<span data-clip-icon ></span>"),t(this).find("[data-clip-icon]").fadeOut(1e3,function(){t(this).remove()})})})}(jQuery),function(r){"use strict";r(document).ready(function(){r("#import_tracker_settings_modal").ready(function(){var e=r("#import_tracker_settings_modal"),a=r(e).find("form"),t=r(e).find('button[type="submit"]'),n=r(e).find(".ux-select");a.submit(function(e){e.preventDefault();var a=r(this).find('button[type="submit"]'),t=a.html();a.html('<i class="fa fa-spinner fa-spin"></i>');var n=r("#campaign_id").val(),i=r(this).serializeArray();i.push({name:"cp_id",value:n}),i.push({name:"action",value:"appq_integration_center_import_tracker_settings"}),i.push({name:"nonce",value:integration_center_obj.nonce}),jQuery.ajax({type:"post",dataType:"json",url:integration_center_obj.ajax_url,data:i}).then(function(e){e.success?location.reload():(toastr.error(e.data),a.html(t))})}),n.on("select2:select",function(e){t.prop("disabled",!1)}),n.on("select2:unselect",function(e){t.prop("disabled",!0)})}),r("#custom_tracker_settings_modal").ready(function(){var a=r("#custom_tracker_settings_modal"),t=r(a).find(".confirm"),n=r(a).find(".ux-select"),i=n.val()?n.val()+"_tracker_settings":"",s=r(a).find(".settings");t.on("click",function(){var e=r(this),a=e.html();e.html('<i class="fa fa-spinner fa-spin"></i>'),r("#"+i).trigger("submit"),e.html(a)}),n.on("select2:select",function(e){s.show(),a.find(".extra-fields").hide(),a.find('[data-tracker="'+n.val()+'"]').show(),t.prop("disabled",!1),i=n.val()+"_tracker_settings"}),n.on("select2:unselect",function(e){s.hide(),t.prop("disabled",!0)})})})}(jQuery),function(n){"use strict";n(document).ready(function(){n("#delete_tracker_settings").click(function(e){e.preventDefault();var a=n("#campaign_id").val(),t=[];t.push({name:"action",value:"appq_integration_center_delete_tracker_settings"}),t.push({name:"cp_id",value:a}),t.push({name:"nonce",value:integration_center_obj.nonce}),jQuery.ajax({type:"post",dataType:"json",url:integration_center_obj.ajax_url,data:t,success:function(e){location.reload()}})})})}(jQuery),function(a){"use strict";a(document).ready(function(){a.fn.modal.Constructor.prototype.enforceFocus=function(){},a(".ux-select").each(function(){var e={width:"100%"};a(this).data("parent")&&a(a(this).data("parent")).length&&(e.dropdownParent=a(a(this).data("parent"))),a(this).data("clear")&&(e.allowClear=!0),a(this).select2(e)})})}(jQuery);
>>>>>>> 3fdc55d471f26b41ee0aa9a2e9562a467a8ae8fa
