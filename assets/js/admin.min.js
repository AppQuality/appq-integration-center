!function(u){"use strict";var _x=wp.i18n._x;u(document).ready(function(){function c(a){for(var e=u(".custom_field_map").length;0!=a.parent().find('[id^="custom_field_maps_wrap"] input[name="custom_map['+e+'][key]"]').length;)e++;var t=u(u("#field_map_template").html());return t.find('input[name="key"]').attr("name","custom_map["+e+"][key]"),t.find('input[name="value"]').attr("name","custom_map["+e+"][value]"),a.parent().find('[id^="custom_field_maps"]').append(t),t}u(".delete_issue").length&&u(".delete_issue").click(function(a){a.preventDefault();var e=u("#cp_id").val(),t=u(this).closest("tr").find("td.name").text(),n=u(this).attr("data-bugtracker-id");if(confirm(__x("Are you sure you want to delete issue","Integration Center delete issue","appq-integration-center")+" "+n+" - "+t+"?")){var i=u(this).removeClass("fa-close"),s=this;u(this).html('<span class="fa fa-spin fa-spinner"></span>'),u.ajax({type:"post",dataType:"json",url:custom_object.ajax_url,data:{action:"appq_delete_bug_from_bugtracker",cp_id:e,bugtracker_id:n}}).then(function(a){a.success?(u(s).closest("td").find(".open_bug_menu").removeClass("fa-upload").addClass("fa-close").addClass("text-danger"),u(s).closest("tr").find(".is_uploaded").html(""),u(s).closest("td").find("button").prop("disabled",!0),u(s).remove(),a.data.auth_error?toastr.warning(a.data.message):toastr.success(a.data.message)):(u(s).html(i),toastr.error(a.data.message))})}}),u(".open_bug_menu").length&&u(".open_bug_menu").click(function(a){a.preventDefault(),u(this).closest("td").find(".bug_menu").is(":visible")?u(this).closest("td").find(".bug_menu").hide():(u(".bug_menu").hide(),u(this).closest("td").find(".bug_menu").show())}),u("#custom_field_maps").on("click",".remove",function(){u(this).closest(".custom_field_map").remove()}),u("#add_field_modal, #edit_available_field_modal").on("hidden.bs.modal",function(a){u("#add_field_modal").find("input").val(""),u("#edit_available_field_modal").find("input").val(""),u("#custom_field_maps_add *").remove(),u("#custom_field_maps_edit *").remove()}),u(".available_fields .custom").length&&u(".available_fields .custom").click(function(){var t=u(this).data("map"),a=u(this).data("source"),e=u(this).data("name"),n=u(u(this).data("target"));n.find('input[name="custom_map_source"]').val(a),n.find('input[name="custom_map_name"]').val(e),Object.keys(t).forEach(function(a){var e=c();e.find(".key").val(a),e.find(".value").val(t[a])}),n.modal("show")}),u(".add_new_field_map").click(function(a){c(u(this))}),u("#add_new_field, #edit_field").click(function(a){a.preventDefault();var e,t,n,i,s=this,o=u(this).html(),d=u("#cp_id").val();"edit_field"===u(this).attr("id")?(e="#edit_available_field_form",t="appq_edit_custom_field",n=4,i=_x("Custom field updated","Integration Center edit available field","appq-integration-center")):"add_new_field"===u(this).attr("id")&&(e="#add_custom_map",t="appq_add_custom_field",n=4,i=_x("Custom field added","Integration Center add available field","appq-integration-center"));var r=u(e+" input").serializeArray();if(u(this).html('<i class="fa fa-spinner fa-spin"></i>'),r.length>=n){var l=!0;r.forEach(function(a,e){a.value||(l=!1)}),l?(u(s).prop("disabled",!0),r.push({name:"cp_id",value:d}),r.push({name:"action",value:t}),u.ajax({type:"post",dataType:"json",url:custom_object.ajax_url,data:r}).then(function(a){a.success?(toastr.success(i),location.reload()):toastr.error(__x("Something went wrong","Integration Center available fields modal error","appq-integration-center")),u(s).html(o),u(s).prop("disabled",!1)})):(toastr.error(__x("Please fill the mapping fields","Integration Center available fields modal error","appq-integration-center")),u(s).html(o),u(s).prop("disabled",!1))}else toastr.error(__x("Please fill the mapping fields","Integration Center available fields modal error","appq-integration-center")),u(s).html(o),u(s).prop("disabled",!1)}),u(document).on("click",'[data-target="#add_field_modal"]',function(){u("#add_new_field").prop("disabled",!1)}),u(document).on("click",'[data-target="#edit_available_field_modal"]',function(){var a=u(this).attr("data-target"),e=u(a),t=e.find('input[name="custom_map_source"]'),n=e.find('input[name="custom_map_name"]'),i=u(this).data("source"),s=u(this).data("name"),o=u(this).data("map"),d=0;for(var r in o){var l=o[r];c(u("#add_new_field_map")),e.find('input[name="custom_map['+d+'][key]"]').val(r),e.find('input[name="custom_map['+d+'][value]"]').val(l),d++}t.val(i),n.val(s)}),u(document).on("click",'[data-target="#delete_available_field_modal"]',function(){var a=u(this).attr("data-target"),e=u(a).find('input[name="name"]');e.val("");var t=u(this).data("name");t&&e.val(t)}),u("#delete_available_field").click(function(a){a.preventDefault();var e=this,t=u(this).html(),n=u("#cp_id").val();u(this).html('<i class="fa fa-spinner fa-spin"></i>'),u(this).prop("disabled",!0);var i=u("#delete_available_field_form").find('input[name="name"]').val(),s=[];s.push({name:"cp_id",value:n}),s.push({name:"name",value:i}),s.push({name:"action",value:"appq_delete_custom_field"}),u.ajax({type:"post",dataType:"json",url:custom_object.ajax_url,data:s}).then(function(a){a.success?(u("#accordionFields").find('tr[data-name="'+i+'"]').remove(),toastr.error(__x("Custom field deleted","Integration Center delete custom field","appq-integration-center"))):toastr.error(__x("There was an error deleting custom field","Integration Center delete custom field error","appq-integration-center")),u(e).html(t),u(e).prop("disabled",!1),u("#delete_available_field_modal").modal("toggle")})}),u("#bugs-tabs-content .upload_bug").not(".disabled").click(function(){var a=u("#cp_id").val(),e=u(this).data("bug-id"),t=u(this);t.removeClass("fa-upload").addClass("fa-spinner fa-spin text-secondary disabled"),jQuery.ajax({type:"post",dataType:"json",url:custom_object.ajax_url,data:{action:"appq_upload_bugs_to_bugtracker",cp_id:a,bug_id:e},success:function(a){t.removeClass("fa-spinner fa-spin").addClass("fa-upload"),a.success?t.closest("tr").find("td.is_uploaded").append('<span class="fa fa-check"></span>'):a.data.warning?(t.closest("tr").find("td.is_uploaded").append('<span class="fa fa-check"></span>'),toastr.warning(a.data.warning,"Your bug was uploaded, but there was some errors")):(t.removeClass("text-secondary disabled"),toastr.error(a.data))},error:function(a){t.removeClass("fa-spinner fa-spin text-secondary").addClass("fa-upload"),toastr.error(JSON.stringify(a))}})}),u("#bugs-tabs-content .update_bug").not(".disabled").click(function(){var a=u("#cp_id").val(),e=u(this).data("bug-id"),t=u(this);t.removeClass("fa-upload").addClass("fa-spinner fa-spin text-secondary disabled"),jQuery.ajax({type:"post",dataType:"json",url:custom_object.ajax_url,data:{action:"appq_update_bugs_in_bugtracker",cp_id:a,bug_id:e},success:function(a){t.removeClass("fa-spinner fa-spin").addClass("fa-upload"),a.success?toastr.success(__x("Updated!","Integration Center available fields modal error","appq-integration-center")):(t.removeClass("text-secondary disabled"),toastr.error(a.data))},error:function(a){t.removeClass("fa-spinner fa-spin text-secondary").addClass("fa-upload"),toastr.error(JSON.stringify(a))}})}),u("#campaign-tabs .nav-link").click(function(){window.location.hash=u(this).attr("href")});var a=window.location.hash;u('#campaign-tabs a[href="'+a+'"]').click();new List("campaigns_list",{valueNames:["id","name","bugtracker"],plugins:[ListFuzzySearch({searchClass:"fuzzy-search",location:0,distance:100,threshold:.4,multiSearch:!0})]});var t=new List("bugs_list",{valueNames:["id","name","category","status","severity","tags","uploaded","duplicated"]});u("#bugs_list .send-all").click(function(a){a.preventDefault(),confirm(__x('Are you sure you want to process ALL the bugs? It will take a while. The list could contain REFUSED and PENDING bugs. If you want to send only some bugs, please use the "Send Selected" button.',"Integration Center send all confirm","appq-integration-center"))&&u("#bugs_list .fa-upload").not(".text-secondary").click()}),u("#bugs_list .send-selected").click(function(a){a.preventDefault(),u("#bugs_list .check:checked").each(function(){u(this).closest("tr").find(".fa-upload").not(".text-secondary").click()})}),u("#bugs_list .select_all").change(function(){u(this).prop("checked")?u("#bugs_list input.check").prop("checked",!0):u("#bugs_list input.check").prop("checked",!1)}),u("#bugs_list-search").on("keyup",function(){var e=u(this).val().split(" ").map(function(a){return a.split("+")});t.filter(function(a){var t=a.values();t=(t=Object.keys(t).map(function(a){return t[a]})).join(" ").toLowerCase();var n=!1;return e.forEach(function(a){var e=!0;a.forEach(function(a){a=a.toLowerCase(),e=e&&t.includes(a)}),n=n||e}),n})}),u("#save_general_settings").click(function(){var a=u("#campaign_id").val(),e=u(this),t=e.text(),n=u("#general_settings").serializeArray();n.push({name:"action",value:"appq_integration_center_save_settings"}),n.push({name:"cp_id",value:a}),e.text(""),e.append('<span class="fa fa-spinner fa-spin"></span>'),jQuery.ajax({type:"post",dataType:"json",url:custom_object.ajax_url,data:n,success:function(a){e.text(t)}})}),u("#import_default_bug").click(function(a){a.preventDefault();var e=u("#cp_id").val(),t=u(this),n=u(this).html();t.html('<i class="fa fa-spinner fa-spin"></i>'),jQuery.ajax({type:"post",dataType:"json",url:custom_object.ajax_url,data:{action:"appq_upload_bugs_to_bugtracker",cp_id:e,bug_id:"default"},success:function(a){t.html(n),a.success?(toastr.success(__x("Default bug uploaded","Integration Center default bug upload","appq-integration-center")),t.prop("disabled",!0),location.reload()):toastr.error(a.data)},error:function(a){t.html(n),toastr.error(JSON.stringify(a))}})}),u("#update_default_bug").click(function(a){a.preventDefault();var e=u("#cp_id").val(),t=u(this),n=u(this).html();t.html('<i class="fa fa-spinner fa-spin"></i>'),jQuery.ajax({type:"post",dataType:"json",url:custom_object.ajax_url,data:{action:"appq_update_bugs_in_bugtracker",cp_id:e,bug_id:"default"},success:function(a){t.html(n),a.success?toastr.success(__x("Default bug updated","Integration Center default bug update","appq-integration-center")):toastr.error(a.data)},error:function(a){t.html(n),toastr.error(JSON.stringify(a))}})})})}(jQuery),function(e){"use strict";console.log("ci test"),e(document).ready(function(){e("#add_new_field_values").change(function(){e("#custom_field_maps_wrap").toggle()}),e(".available_fields .custom").click(function(){e("#add_new_field_values").is(":checked")||e("#add_new_field_values").click()}),e("#add_field_modal").on("hidden.bs.modal",function(a){e("#add_new_field_values").is(":checked")&&e("#add_new_field_values").click(),e("#add_new_field").prop("disabled",!0),e("#custom_field_maps").html(""),e("#custom_map_source").val(""),e("#custom_map_name").val("")})})}(jQuery),function(t){"use strict";t(document).ready(function(){t("[data-copy-to-clipboard]").click(function(a){t(this).append("<input>"),t(this).find("input").val(t(this).text());var e=t(this).find("input")[0];e.select(),e.setSelectionRange(0,9999999),document.execCommand("copy"),t(this).find("input").remove(),t(this).append("<span data-clip-icon ></span>"),t(this).find("[data-clip-icon]").fadeOut(1e3,function(){t(this).remove()})})})}(jQuery),function(o){"use strict";o(document).ready(function(){o("#import_tracker_settings_modal").ready(function(){var a=o("#import_tracker_settings_modal"),e=o(a).find("form"),t=o(a).find('button[type="submit"]'),n=o(a).find(".ux-select");e.submit(function(a){a.preventDefault();var e=o(this).find('button[type="submit"]'),t=e.html();e.html('<i class="fa fa-spinner fa-spin"></i>');var n=o("#campaign_id").val(),i=o(this).serializeArray();i.push({name:"cp_id",value:n}),i.push({name:"action",value:"appq_integration_center_import_tracker_settings"}),i.push({name:"nonce",value:appq_ajax.nonce}),jQuery.ajax({type:"post",dataType:"json",url:appq_ajax.url,data:i}).then(function(a){a.success?location.reload():(toastr.error(a.data),e.html(t))})}),n.on("select2:select",function(a){t.prop("disabled",!1)}),n.on("select2:unselect",function(a){t.prop("disabled",!0)})}),o("#custom_tracker_settings_modal").ready(function(){var e=o("#custom_tracker_settings_modal"),t=o(e).find(".confirm"),n=o(e).find(".ux-select"),i=n.val()?n.val()+"_tracker_settings":"",s=o(e).find(".settings");t.on("click",function(){var a=o(this),e=a.html();a.html('<i class="fa fa-spinner fa-spin"></i>'),o("#"+i).trigger("submit"),a.html(e)}),n.on("select2:select",function(a){s.show(),e.find(".extra-fields").hide(),e.find('[data-tracker="'+n.val()+'"]').show(),t.prop("disabled",!1),i=n.val()+"_tracker_settings"}),n.on("select2:unselect",function(a){s.hide(),t.prop("disabled",!0)})})})}(jQuery),function(e){"use strict";e(document).ready(function(){e.fn.modal.Constructor.prototype.enforceFocus=function(){},e(".ux-select").each(function(){var a={width:"100%"};e(this).data("parent")&&e(e(this).data("parent")).length&&(a.dropdownParent=e(e(this).data("parent"))),e(this).data("clear")&&(a.allowClear=!0),e(this).select2(a)})})}(jQuery);